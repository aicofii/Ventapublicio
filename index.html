<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>收银系统 - 超市</title>
  <!-- Load Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Load React and ReactDOM -->
  <script src="https://cdn.jsdelivr.net/npm/react@18.3.1/umd/react.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/react-dom@18.3.1/umd/react-dom.production.min.js"></script>
  <!-- Load Babel for JSX transformation -->
  <script src="https://cdn.jsdelivr.net/npm/@babel/standalone@7.25.6/babel.min.js"></script>
  <!-- CDN Fallback Check -->
  <script>
    window.addEventListener('load', function() {
      if (!window.React || !window.ReactDOM || !window.Babel) {
        var errorDiv = document.getElementById('error-message');
        errorDiv.classList.remove('hidden');
        errorDiv.innerText = 
          localStorage.getItem('language') === 'es' 
            ? 'Error: No se pudieron cargar los recursos necesarios. Verifica tu conexión a internet o intenta con otro navegador (como Chrome o Firefox).'
            : '错误：无法加载必要资源。请检查网络连接或尝试使用其他浏览器（如 Chrome、Firefox）。';
      }
    });
  </script>
</head>
<body className="bg-gray-100 font-sans">
  <!-- Fallback message if JavaScript fails -->
  <div id="error-message" className="hidden text-center p-4 text-red-600"></div>
  <!-- Root element for React -->
  <div id="root"></div>

  <script type="text/babel">
    // Mock product database with stock and safety stock
    const products = [
      { id: "1001", name: "全脂牛奶", name_es: "Leche entera", price: 1.20, barcode: "123456789", stock: 50, safetyStock: 20 },
      { id: "1002", name: "切片面包", name_es: "Pan de molde", price: 2.00, barcode: "987654321", stock: 15, safetyStock: 10 },
      { id: "1003", name: "苹果（公斤）", name_es: "Manzanas (kg)", price: 3.50, barcode: "456789123", stock: 30, safetyStock: 25 },
      { id: "1004", name: "可乐（500ml）", name_es: "Cola (500ml)", price: 1.50, barcode: "111222333", stock: 40, safetyStock: 15 },
      { id: "1005", name: "薯片（100g）", name_es: "Patatas fritas (100g)", price: 2.00, barcode: "444555666", stock: 25, safetyStock: 10 },
      { id: "1006", name: "洗洁精（1L）", name_es: "Detergente (1L)", price: 3.00, barcode: "777888999", stock: 20, safetyStock: 8 },
      { id: "1007", name: "香蕉（公斤）", name_es: "Plátanos (kg)", price: 2.80, barcode: "222333444", stock: 35, safetyStock: 20 },
      { id: "1008", name: "西红柿（公斤）", name_es: "Tomates (kg)", price: 4.00, barcode: "555666777", stock: 28, safetyStock: 15 },
      { id: "1009", name: "土豆（公斤）", name_es: "Patatas (kg)", price: 1.80, barcode: "888999111", stock: 50, safetyStock: 30 }
    ];

    // Translations object
    const translations = {
      zh: {
        title: "收银系统 - 超市",
        pos: "POS",
        sales: "销售",
        inventory: "库存",
        membership: "会员",
        payments: "支付",
        reports: "报告",
        users: "用户",
        tickets: "票据",
        debt: "记账",
        newSale: "新增销售",
        scanProduct: "扫描产品",
        barcodePlaceholder: "条形码或PLU（按回车）",
        manualInput: "手动输入",
        discount: "折扣 (%)",
        suspend: "挂起",
        memberPrice: "会员价格",
        viewSuspended: "查看挂起交易",
        cart: "购物车",
        noProducts: "购物车中没有产品。",
        product: "产品",
        unitPrice: "单价",
        quantity: "数量",
        stock: "库存",
        total: "总计",
        actions: "操作",
        totalAmount: "总计",
        originalPrice: "原价",
        discountedPrice: "折扣价",
        restore: "恢复",
        checkout: "结算",
        addProduct: "添加产品",
        searchProducts: "搜索现有产品",
        searchPlaceholder: "输入产品名称",
        addCustom: "添加自定义产品",
        weighProduct: "称重产品",
        weighNamePlaceholder: "输入产品名称（如：苹果）",
        weighAmountPlaceholder: "输入重量（公斤）",
        weighPricePlaceholder: "输入单价（€/公斤）",
        autoMatch: "自动匹配",
        addWeighProduct: "添加称重产品",
        close: "关闭",
        selectMemberPrice: "选择会员价格",
        memberPrice1: "会员价格1（10%折扣）",
        memberPrice2: "会员价格2（15%折扣）",
        cancel: "取消",
        suspendedTransactions: "挂起交易",
        noSuspended: "没有挂起的交易。",
        selectPayment: "选择支付方式",
        card: "刷卡",
        cash: "现金",
        debtPayment: "记账",
        addCustomer: "添加客户",
        amountDue: "应付金额",
        receivedAmount: "实收金额",
        change: "找零",
        confirm: "确认",
        createCustomer: "创建客户",
        selectCustomer: "选择客户",
        customerCode: "客户代码",
        customerName: "客户名称",
        customerTaxNumber: "客户税号",
        customerPhone: "客户电话",
        customerCodePlaceholder: "请输入客户代码",
        customerNamePlaceholder: "请输入客户名称",
        customerTaxNumberPlaceholder: "请输入客户税号",
        customerPhonePlaceholder: "请输入客户电话",
        save: "保存",
        complete: "完成",
        errorRender: "渲染应用程序时出错：{error}。请查看浏览器控制台或联系支持。",
        errorEmptyCart: "购物车为空，无法结算。",
        errorEmptyCartSuspend: "购物车为空，无法挂单。",
        errorNoProduct: "未找到产品",
        errorEmptySearch: "请输入产品名称。",
        errorInvalidWeigh: "请填写称重产品的名称、重量和单价。",
        errorNegativeWeigh: "重量和单价必须大于0。",
        errorCustomerRequired: "客户代码、客户名称和电话为必填项！",
        errorCustomerSelectRequired: "客户名称和电话为必填项！",
        errorInsufficientCash: "实收金额不足以支付应付金额！",
        errorDiscountApplied: "已应用折扣，无法同时应用会员价格。",
        errorEmptyCartMember: "购物车中没有产品可应用会员价格。",
        errorNoSuspend: "购物车中没有产品可挂起。",
        selectLanguage: "选择语言",
        spanish: "西班牙语",
        chinese: "中文",
        inventoryModule: "库存模块（待实现：入库、出库、库存、警报）",
        membershipModule: "会员与促销模块（待实现：注册、积分、促销）",
        paymentsModule: "支付与结算模块（待实现：支付、每日报告）",
        reportsModule: "报告与分析模块（待实现：销售、库存、财务）",
        usersModule: "用户与权限模块（待实现：角色、权限、审计）"
      },
      es: {
        title: "Sistema de Caja - Supermercado",
        pos: "POS",
        sales: "Ventas",
        inventory: "Inventario",
        membership: "Membresía",
        payments: "Pagos",
        reports: "Informes",
        users: "Usuarios",
        tickets: "Tickets",
        debt: "Deuda",
        newSale: "Nueva Venta",
        scanProduct: "Escanear Producto",
        barcodePlaceholder: "Código de barras o PLU (presiona Enter)",
        manualInput: "Entrada Manual",
        discount: "Descuento (%)",
        suspend: "Suspender",
        memberPrice: "Precio para Miembros",
        viewSuspended: "Ver Transacciones Suspendidas",
        cart: "Carrito",
        noProducts: "No hay productos en el carrito.",
        product: "Producto",
        unitPrice: "Precio Unitario",
        quantity: "Cantidad",
        stock: "Stock",
        total: "Total",
        actions: "Acciones",
        totalAmount: "Total",
        originalPrice: "Precio Original",
        discountedPrice: "Precio con Descuento",
        restore: "Restablecer",
        checkout: "Pagar",
        addProduct: "Agregar Producto",
        searchProducts: "Buscar Productos Existentes",
        searchPlaceholder: "Ingresa el nombre del producto",
        addCustom: "Agregar Producto Personalizado",
        weighProduct: "Producto Pesado",
        weighNamePlaceholder: "Ingresa el nombre del producto (ej: Manzanas)",
        weighAmountPlaceholder: "Ingresa el peso (kg)",
        weighPricePlaceholder: "Ingresa el precio unitario (€/kg)",
        autoMatch: "Coincidencia Automática",
        addWeighProduct: "Agregar Producto Pesado",
        close: "Cerrar",
        selectMemberPrice: "Seleccionar Precio para Miembros",
        memberPrice1: "Precio Miembro 1 (10% descuento)",
        memberPrice2: "Precio Miembro 2 (15% descuento)",
        cancel: "Cancelar",
        suspendedTransactions: "Transacciones Suspendidas",
        noSuspended: "No hay transacciones suspendidas.",
        selectPayment: "Seleccionar Método de Pago",
        card: "Tarjeta",
        cash: "Efectivo",
        debtPayment: "A Cuenta",
        addCustomer: "Agregar Cliente",
        amountDue: "Monto a Pagar",
        receivedAmount: "Monto Recibido",
        change: "Cambio",
        confirm: "Confirmar",
        createCustomer: "Crear Cliente",
        selectCustomer: "Seleccionar Cliente",
        customerCode: "Código de Cliente",
        customerName: "Nombre del Cliente",
        customerTaxNumber: "Número de Identificación Fiscal",
        customerPhone: "Teléfono del Cliente",
        customerCodePlaceholder: "Ingresa el código de cliente",
        customerNamePlaceholder: "Ingresa el nombre del cliente",
        customerTaxNumberPlaceholder: "Ingresa el número de identificación fiscal",
        customerPhonePlaceholder: "Ingresa el teléfono del cliente",
        save: "Guardar",
        complete: "Completar",
        errorRender: "Error al renderizar la aplicación: {error}. Consulta la consola del navegador o contacta al soporte.",
        errorEmptyCart: "El carrito está vacío, no se puede proceder al pago.",
        errorEmptyCartSuspend: "El carrito está vacío, no se puede suspender.",
        errorNoProduct: "Producto no encontrado",
        errorEmptySearch: "Por favor, ingresa el nombre del producto.",
        errorInvalidWeigh: "Por favor, completa el nombre, peso y precio unitario del producto pesado.",
        errorNegativeWeigh: "El peso y el precio unitario deben ser mayores a 0.",
        errorCustomerRequired: "¡El código, nombre y teléfono del cliente son obligatorios!",
        errorCustomerSelectRequired: "¡El nombre y teléfono del cliente son obligatorios!",
        errorInsufficientCash: "¡El monto recibido no es suficiente para cubrir el monto a pagar!",
        errorDiscountApplied: "Ya se ha aplicado un descuento, no se puede aplicar un precio de miembro simultáneamente.",
        errorEmptyCartMember: "No hay productos en el carrito para aplicar un precio de miembro.",
        errorNoSuspend: "No hay productos en el carrito para suspender.",
        selectLanguage: "Seleccionar Idioma",
        spanish: "Español",
        chinese: "Chino",
        inventoryModule: "Módulo de Inventario (por implementar: entrada, salida, stock, alertas)",
        membershipModule: "Módulo de Membresía y Promociones (por implementar: registro, puntos, promociones)",
        paymentsModule: "Módulo de Pagos y Liquidaciones (por implementar: pagos, informes diarios)",
        reportsModule: "Módulo de Informes y Análisis (por implementar: ventas, inventario, finanzas)",
        usersModule: "Módulo de Usuarios y Permisos (por implementar: roles, permisos, auditoría)"
      }
    };

    // Error Boundary Component
    class ErrorBoundary extends React.Component {
      constructor(props) {
        super(props);
        this.state = { hasError: false, errorMessage: '' };
      }
      static getDerivedStateFromError(error) {
        return { hasError: true, errorMessage: error.message };
      }
      render() {
        if (this.state.hasError) {
          return (
            <div className="text-red-600 p-4 text-center">
              {this.props.t.errorRender.replace('{error}', this.state.errorMessage)}
            </div>
          );
        }
        return this.props.children;
      }
    }

    // Member Price Modal Component
    function MemberPriceModal({ isOpen, onSelectPrice, onClose, t }) {
      if (!isOpen) return null;

      function handleSelectPrice(discount) {
        onSelectPrice(discount);
        onClose();
      }

      return (
        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
          <div className="bg-white rounded-lg p-6 w-1/3">
            <h2 className="text-xl font-bold mb-4">{t.selectMemberPrice}</h2>
            <div className="flex flex-col space-y-2 mb-4">
              <button
                onClick={() => handleSelectPrice(10)}
                className="p-3 rounded text-lg bg-gray-200 hover:bg-gray-300"
              >
                {t.memberPrice1}
              </button>
              <button
                onClick={() => handleSelectPrice(15)}
                className="p-3 rounded text-lg bg-gray-200 hover:bg-gray-300"
              >
                {t.memberPrice2}
              </button>
            </div>
            <button
              onClick={onClose}
              className="bg-gray-500 text-white p-2 rounded w-full hover:bg-gray-600"
            >
              {t.cancel}
            </button>
          </div>
        </div>
      );
    }

    // Manual Product Modal Component
    function ProductModal({ isOpen, onClose, onSelectProduct, products, t }) {
      const [searchTerm, setSearchTerm] = React.useState("");
      const [weighName, setWeighName] = React.useState("");
      const [weighAmount, setWeighAmount] = React.useState("");
      const [weighPrice, setWeighPrice] = React.useState("1.00");

      const filteredProducts = products.filter(function(product) {
        return product[t.lang === 'es' ? 'name_es' : 'name'].toLowerCase().includes(searchTerm.toLowerCase());
      });

      // 监听 weighName 变化，自动匹配产品单价
      React.useEffect(function() {
        var matchedProduct = products.find(function(product) {
          return product[t.lang === 'es' ? 'name_es' : 'name'].toLowerCase().includes(weighName.toLowerCase());
        });
        if (matchedProduct) {
          setWeighPrice(matchedProduct.price.toFixed(2));
        } else {
          setWeighPrice("1.00");
        }
      }, [weighName, products, t.lang]);

      function handleSelect(product) {
        onSelectProduct(product);
        setSearchTerm("");
        onClose();
      }

      function handleCustomProduct() {
        if (!searchTerm) {
          alert(t.errorEmptySearch);
          return;
        }
        var customProduct = {
          id: "manual-" + Date.now() + "-" + Math.random().toString(36).slice(2, 9),
          name: searchTerm,
          name_es: searchTerm,
          price: 1.00,
          quantity: 1,
          stock: 0,
          safetyStock: 0
        };
        onSelectProduct(customProduct);
        setSearchTerm("");
        onClose();
      }

      function handleWeighProduct() {
        if (!weighName || !weighAmount || !weighPrice) {
          alert(t.errorInvalidWeigh);
          return;
        }
        if (parseFloat(weighAmount) <= 0 || parseFloat(weighPrice) <= 0) {
          alert(t.errorNegativeWeigh);
          return;
        }
        var weighProduct = {
          id: "weigh-" + Date.now() + "-" + Math.random().toString(36).slice(2, 9),
          name: weighName + "（" + parseFloat(weighAmount).toFixed(2) + "公斤）",
          name_es: weighName + " (" + parseFloat(weighAmount).toFixed(2) + "kg)",
          price: parseFloat(weighPrice) * parseFloat(weighAmount),
          quantity: 1,
          stock: 0,
          safetyStock: 0
        };
        onSelectProduct(weighProduct);
        setWeighName("");
        setWeighAmount("");
        setWeighPrice("1.00");
        onClose();
      }

      if (!isOpen) return null;

      return (
        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
          <div className="bg-white rounded-lg p-6 w-1/3">
            <h2 className="text-xl font-bold mb-4">{t.addProduct}</h2>
            <div className="mb-4">
              <h3 className="text-lg font-semibold mb-2">{t.searchProducts}</h3>
              <input
                type="text"
                value={searchTerm}
                onChange={function(e) { setSearchTerm(e.target.value); }}
                placeholder={t.searchPlaceholder}
                className="border p-2 rounded w-full mb-2"
                autoFocus
              />
              {searchTerm && filteredProducts.length === 0 && (
                <button
                  onClick={handleCustomProduct}
                  className="bg-blue-600 text-white p-2 rounded w-full mb-2 hover:bg-blue-700"
                >
                  {t.addCustom}: "{searchTerm}" (€1.00)
                </button>
              )}
              <div className="max-h-40 overflow-y-auto">
                {filteredProducts.map(function(product) {
                  return (
                    <div
                      key={product.id}
                      className="p-2 hover:bg-gray-100 cursor-pointer border-b"
                      onClick={function() { handleSelect({ ...product, quantity: 1 }); }}
                    >
                      {t.lang === 'es' ? product.name_es : product.name} - €{product.price.toFixed(2)} ({t.stock}: {product.stock})
                    </div>
                  );
                })}
              </div>
            </div>
            <div className="mb-4">
              <h3 className="text-lg font-semibold mb-2">{t.weighProduct}</h3>
              <input
                type="text"
                value={weighName}
                onChange={function(e) { setWeighName(e.target.value); }}
                placeholder={t.weighNamePlaceholder}
                className="border p-2 rounded w-full mb-2"
              />
              <input
                type="number"
                value={weighAmount}
                onChange={function(e) { setWeighAmount(e.target.value); }}
                placeholder={t.weighAmountPlaceholder}
                className="border p-2 rounded w-full mb-2"
                min="0"
                step="0.01"
              />
              <div className="relative">
                <input
                  type="number"
                  value={weighPrice}
                  onChange={function(e) { setWeighPrice(e.target.value); }}
                  placeholder={t.weighPricePlaceholder}
                  className="border p-2 rounded w-full mb-2"
                  min="0"
                  step="0.01"
                />
                {products.some(function(p) { return p[t.lang === 'es' ? 'name_es' : 'name'].toLowerCase().includes(weighName.toLowerCase()); }) && (
                  <span className="absolute right-2 top-2 text-sm text-gray-500">
                    {t.autoMatch}
                  </span>
                )}
              </div>
              {weighAmount && weighPrice && (
                <p className="text-sm text-gray-600 mb-2">
                  {t.total}: €{(parseFloat(weighAmount) * parseFloat(weighPrice)).toFixed(2)}
                </p>
              )}
              <button
                onClick={handleWeighProduct}
                className="bg-green-600 text-white p-2 rounded w-full hover:bg-green-700"
              >
                {t.addWeighProduct}
              </button>
            </div>
            <button
              onClick={onClose}
              className="bg-gray-500 text-white p-2 rounded w-full hover:bg-gray-600"
            >
              {t.close}
            </button>
          </div>
        </div>
      );
    }

    // Suspended Transactions Modal Component
    function SuspendedTransactionsModal({ isOpen, onClose, suspendedTransactions, onResumeTransaction, t }) {
      if (!isOpen) return null;

      return (
        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
          <div className="bg-white rounded-lg p-6 w-1/2">
            <h2 className="text-xl font-bold mb-4">{t.suspendedTransactions}</h2>
            {suspendedTransactions.length === 0 ? (
              <p className="text-gray-500">{t.noSuspended}</p>
            ) : (
              <div className="max-h-64 overflow-y-auto">
                {suspendedTransactions.map(function(transaction, index) {
                  return (
                    <div
                      key={transaction.id}
                      className="p-2 hover:bg-gray-100 cursor-pointer border-b"
                      onClick={function() { onResumeTransaction(transaction); }}
                    >
                      {t.lang === 'es' ? `Transacción ${index + 1}` : `交易 ${index + 1}`} - {transaction.timestamp} (€{transaction.total.toFixed(2)}) - {t.customerName}: {transaction.customerName || t.lang === 'es' ? 'Ninguno' : '无'}
                    </div>
                  );
                })}
              </div>
            )}
            <button
              onClick={onClose}
              className="mt-4 bg-gray-500 text-white p-2 rounded w-full hover:bg-gray-600"
            >
              {t.close}
            </button>
          </div>
        </div>
      );
    }

    // Create Customer Modal Component
    function CreateCustomerModal({ isOpen, onClose, onSave, t }) {
      const [formData, setFormData] = React.useState({
        id: '',
        name: '',
        taxNumber: '',
        phone: ''
      });

      function handleChange(e) {
        var name = e.target.name;
        var value = e.target.value;
        setFormData(function(prev) {
          return { ...prev, [name]: value };
        });
      }

      function handleSubmit() {
        if (!formData.id || !formData.name || !formData.phone) {
          alert(t.errorCustomerRequired);
          return;
        }
        onSave(formData);
        setFormData({ id: '', name: '', taxNumber: '', phone: '' });
        onClose();
      }

      if (!isOpen) return null;

      return (
        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
          <div className="bg-white p-6 rounded-lg shadow-lg w-full max-w-md">
            <h3 className="text-lg font-bold mb-4">{t.createCustomer}</h3>
            <div className="space-y-4">
              <div>
                <label className="block text-sm font-medium text-gray-700">{t.customerCode}</label>
                <input
                  type="text"
                  name="id"
                  value={formData.id}
                  onChange={handleChange}
                  className="mt-1 p-2 w-full border rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
                  placeholder={t.customerCodePlaceholder}
                  required
                />
              </div>
              <div>
                <label className="block text-sm font-medium text-gray-700">{t.customerName}</label>
                <input
                  type="text"
                  name="name"
                  value={formData.name}
                  onChange={handleChange}
                  className="mt-1 p-2 w-full border rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
                  placeholder={t.customerNamePlaceholder}
                  required
                />
              </div>
              <div>
                <label className="block text-sm font-medium text-gray-700">{t.customerTaxNumber}</label>
                <input
                  type="text"
                  name="taxNumber"
                  value={formData.taxNumber}
                  onChange={handleChange}
                  className="mt-1 p-2 w-full border rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
                  placeholder={t.customerTaxNumberPlaceholder}
                />
              </div>
              <div>
                <label className="block text-sm font-medium text-gray-700">{t.customerPhone}</label>
                <input
                  type="text"
                  name="phone"
                  value={formData.phone}
                  onChange={handleChange}
                  className="mt-1 p-2 w-full border rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
                  placeholder={t.customerPhonePlaceholder}
                  required
                />
              </div>
            </div>
            <div className="mt-6 flex justify-end space-x-2">
              <button
                onClick={onClose}
                className="bg-gray-300 text-gray-700 px-4 py-2 rounded hover:bg-gray-400"
              >
                {t.cancel}
              </button>
              <button
                onClick={handleSubmit}
                className="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"
              >
                {t.save}
              </button>
            </div>
          </div>
        </div>
      );
    }

    // Select Customer Modal Component
    function SelectCustomerModal({ isOpen, onClose, onSelectCustomer, customers, cart, discount, onClearCart, t, isDebtPayment }) {
      const [formData, setFormData] = React.useState({
        name: '',
        phone: '',
        taxNumber: ''
      });
      const [isCreateModalOpen, setIsCreateModalOpen] = React.useState(false);

      function handleChange(e) {
        var name = e.target.name;
        var value = e.target.value;
        setFormData(function(prev) {
          return { ...prev, [name]: value };
        });

        var matchedCustomer = customers.find(function(customer) {
          return (
            (name === 'name' && customer.name.toLowerCase() === value.toLowerCase()) ||
            (name === 'phone' && customer.phone === value) ||
            (name === 'taxNumber' && customer.taxNumber === value)
          );
        });

        if (matchedCustomer) {
          setFormData({
            name: matchedCustomer.name,
            phone: matchedCustomer.phone,
            taxNumber: matchedCustomer.taxNumber || ''
          });
        }
      }

      function handleCreateCustomer(newCustomer) {
        var savedCustomers = JSON.parse(localStorage.getItem('customers') || '[]');
        localStorage.setItem('customers', JSON.stringify(savedCustomers.concat([newCustomer])));
        onSelectCustomer(newCustomer);
        setFormData({
          name: newCustomer.name,
          phone: newCustomer.phone,
          taxNumber: newCustomer.taxNumber || ''
        });
        setIsCreateModalOpen(false);
      }

      function handleSubmit() {
        if (!formData.name || !formData.phone) {
          alert(t.errorCustomerSelectRequired);
          return;
        }
        if (isDebtPayment) {
          var subtotal = cart.reduce(function(sum, item) {
            return sum + item.price * item.quantity;
          }, 0);
          var discountAmount = subtotal * (discount / 100);
          var total = (subtotal - discountAmount).toFixed(2);
          var debt = {
            id: "debt-" + Date.now() + "-" + Math.random().toString(36).slice(2, 9),
            cart: cart.slice(),
            discount: discount,
            total: parseFloat(total),
            timestamp: new Date().toLocaleString(t.lang === 'es' ? "es-ES" : "zh-CN"),
            customerName: formData.name,
            customerPhone: formData.phone,
            customerTaxNumber: formData.taxNumber || '',
            status: 'pending'
          };
          var savedDebts = JSON.parse(localStorage.getItem('debts') || '[]');
          localStorage.setItem('debts', JSON.stringify(savedDebts.concat([debt])));
          onClearCart();
        } else {
          onSelectCustomer({
            name: formData.name,
            phone: formData.phone,
            taxNumber: formData.taxNumber || ''
          });
        }
        setFormData({ name: '', phone: '', taxNumber: '' });
        onClose();
      }

      if (!isOpen) return null;

      return (
        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
          <div className="bg-white p-6 rounded-lg shadow-lg w-full max-w-md">
            <h3 className="text-lg font-bold mb-4">{t.selectCustomer}</h3>
            <div className="space-y-4">
              <div>
                <label className="block text-sm font-medium text-gray-700">{t.customerName}</label>
                <input
                  type="text"
                  name="name"
                  value={formData.name}
                  onChange={handleChange}
                  className="mt-1 p-2 w-full border rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
                  placeholder={t.customerNamePlaceholder}
                  required
                />
              </div>
              <div>
                <label className="block text-sm font-medium text-gray-700">{t.customerPhone}</label>
                <input
                  type="text"
                  name="phone"
                  value={formData.phone}
                  onChange={handleChange}
                  className="mt-1 p-2 w-full border rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
                  placeholder={t.customerPhonePlaceholder}
                  required
                />
              </div>
              <div>
                <label className="block text-sm font-medium text-gray-700">{t.customerTaxNumber}</label>
                <input
                  type="text"
                  name="taxNumber"
                  value={formData.taxNumber}
                  onChange={handleChange}
                  className="mt-1 p-2 w-full border rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
                  placeholder={t.customerTaxNumberPlaceholder}
                />
              </div>
            </div>
            <div className="mt-6 flex justify-end space-x-2">
              <button
                onClick={function() { setIsCreateModalOpen(true); }}
                className="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"
              >
                {t.createCustomer}
              </button>
              <button
                onClick={onClose}
                className="bg-gray-300 text-gray-700 px-4 py-2 rounded hover:bg-gray-400"
              >
                {t.cancel}
              </button>
              <button
                onClick={handleSubmit}
                className="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700"
              >
                {t.complete}
              </button>
            </div>
            <CreateCustomerModal
              isOpen={isCreateModalOpen}
              onClose={function() { setIsCreateModalOpen(false); }}
              onSave={handleCreateCustomer}
              t={t}
            />
          </div>
        </div>
      );
    }

    // Cash Payment Modal Component
    function CashPaymentModal({ isOpen, onClose, onConfirm, cart, discount, t, selectedCustomer }) {
      const [receivedAmount, setReceivedAmount] = React.useState("");

      var total = cart.reduce(function(sum, item) {
        return sum + item.price * item.quantity;
      }, 0);
      var discountAmount = total * (discount / 100);
      var amountDue = (total - discountAmount).toFixed(2);
      
      var change = (parseFloat(receivedAmount || 0) - parseFloat(amountDue)).toFixed(2);

      function handleNumberClick(number) {
        setReceivedAmount(function(prev) { return prev + number; });
      }

      function handleDelete() {
        setReceivedAmount(function(prev) { return prev.slice(0, -1); });
      }

      function handleConfirmPayment() {
        if (!receivedAmount || parseFloat(receivedAmount) < parseFloat(amountDue)) {
          alert(t.errorInsufficientCash);
          return;
        }
        var ticket = {
          id: "ticket-" + Date.now() + "-" + Math.random().toString(36).slice(2, 9),
          timestamp: new Date().toLocaleString(t.lang === 'es' ? "es-ES" : "zh-CN"),
          total: parseFloat(amountDue),
          items: cart.map(function(item) {
            return { name: t.lang === 'es' ? item.name_es || item.name : item.name, quantity: item.quantity, price: item.price };
          }),
          discount: discount,
          paymentMethod: "cash",
          receivedAmount: parseFloat(receivedAmount),
          change: parseFloat(change),
          customerName: selectedCustomer?.name || null,
          customerPhone: selectedCustomer?.phone || null,
          customerTaxNumber: selectedCustomer?.taxNumber || null
        };
        var savedTickets = JSON.parse(localStorage.getItem("tickets") || "[]");
        localStorage.setItem("tickets", JSON.stringify(savedTickets.concat([ticket])));
        onConfirm("cash", ticket);
        setReceivedAmount("");
        onClose();
      }

      if (!isOpen) return null;

      return (
        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
          <div className="bg-white rounded-lg p-6 w-1/2 flex">
            <div className="w-1/2 pr-4 flex flex-col space-y-4">
              <div>
                <label className="block text-lg font-medium text-gray-700">{t.amountDue}</label>
                <p className="text-2xl font-bold">€{amountDue}</p>
              </div>
              <div>
                <label className="block text-lg font-medium text-gray-700">{t.receivedAmount}</label>
                <p className="text-2xl font-bold">€{receivedAmount || "0.00"}</p>
              </div>
              <div>
                <label className="block text-lg font-medium text-gray-700">{t.change}</label>
                <p className="text-2xl font-bold">€{receivedAmount ? (change >= 0 ? change : "0.00") : "0.00"}</p>
              </div>
              <div className="flex space-x-2">
                <button
                  onClick={onClose}
                  className="bg-gray-500 text-white px-4 py-2 rounded w-full hover:bg-gray-600"
                >
                  {t.cancel}
                </button>
                <button
                  onClick={handleConfirmPayment}
                  className="bg-green-600 text-white px-4 py-2 rounded w-full hover:bg-green-700"
                >
                  {t.confirm}
                </button>
              </div>
            </div>
            <div className="w-1/2 grid grid-cols-3 gap-2">
              {['1', '2', '3', '4', '5', '6', '7', '8', '9', '0'].map(function(number) {
                return (
                  <button
                    key={number}
                    onClick={function() { handleNumberClick(number); }}
                    className="bg-gray-200 p-4 rounded text-lg hover:bg-gray-300"
                  >
                    {number}
                  </button>
                );
              })}
              <button
                onClick={handleDelete}
                className="bg-red-500 text-white p-4 rounded text-lg hover:bg-red-600"
              >
                ←
              </button>
            </div>
          </div>
        </div>
      );
    }

    // Payment Modal Component
    function PaymentModal({ isOpen, onClose, onConfirm, cart, discount, onClearCart, t }) {
      const [paymentMethod, setPaymentMethod] = React.useState(null);
      const [isSelectCustomerModalOpen, setIsSelectCustomerModalOpen] = React.useState(false);
      const [isCashModalOpen, setIsCashModalOpen] = React.useState(false);
      const [selectedCustomer, setSelectedCustomer] = React.useState(null);
      const [isAddCustomerModalOpen, setIsAddCustomerModalOpen] = React.useState(false);
      const [customers, setCustomers] = React.useState(function() {
        var saved = localStorage.getItem('customers');
        return saved ? JSON.parse(saved) : [];
      });

      function handlePayment(method) {
        if (!cart.length) {
          alert(t.errorEmptyCart);
          return;
        }
        if (method === "cash") {
          setPaymentMethod("cash");
          setIsCashModalOpen(true);
          return;
        }
        if (method === "card") {
          var total = cart.reduce(function(sum, item) {
            return sum + item.price * item.quantity;
          }, 0);
          var discountAmount = total * (discount / 100);
          var finalTotal = (total - discountAmount).toFixed(2);
          var ticket = {
            id: "ticket-" + Date.now() + "-" + Math.random().toString(36).slice(2, 9),
            timestamp: new Date().toLocaleString(t.lang === 'es' ? "es-ES" : "zh-CN"),
            total: parseFloat(finalTotal),
            items: cart.map(function(item) {
              return { name: t.lang === 'es' ? item.name_es || item.name : item.name, quantity: item.quantity, price: item.price };
            }),
            discount: discount,
            paymentMethod: method,
            customerName: selectedCustomer?.name || null,
            customerPhone: selectedCustomer?.phone || null,
            customerTaxNumber: selectedCustomer?.taxNumber || null
          };
          var savedTickets = JSON.parse(localStorage.getItem("tickets") || "[]");
          localStorage.setItem("tickets", JSON.stringify(savedTickets.concat([ticket])));
          onConfirm(method, ticket);
          setSelectedCustomer(null);
          onClose();
        }
      }

      function handleSelectCustomer(newCustomer) {
        setCustomers(function(prev) {
          return prev.concat([newCustomer]);
        });
        setSelectedCustomer(newCustomer);
        setIsSelectCustomerModalOpen(false);
        setIsAddCustomerModalOpen(false);
      }

      if (!isOpen) return null;

      return (
        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
          <div className="bg-white rounded-lg p-6 w-1/3">
            <h2 className="text-xl font-bold mb-4">{t.selectPayment}</h2>
            <div className="flex flex-col space-y-2 mb-4">
              <button
                onClick={function() { handlePayment("card"); }}
                className={paymentMethod === "card" ? "p-3 rounded text-lg bg-blue-600 text-white" : "p-3 rounded text-lg bg-gray-200 hover:bg-gray-300"}
              >
                {t.card}
              </button>
              <button
                onClick={function() { handlePayment("cash"); }}
                className={paymentMethod === "cash" ? "p-3 rounded text-lg bg-blue-600 text-white" : "p-3 rounded text-lg bg-gray-200 hover:bg-gray-300"}
              >
                {t.cash}
              </button>
              <button
                onClick={function() {
                  if (!cart.length) {
                    alert(t.errorEmptyCartSuspend);
                    return;
                  }
                  setPaymentMethod("suspend");
                  setIsSelectCustomerModalOpen(true);
                }}
                className={paymentMethod === "suspend" ? "p-3 rounded text-lg bg-blue-600 text-white" : "p-3 rounded text-lg bg-gray-200 hover:bg-gray-300"}
              >
                {t.debtPayment}
              </button>
              <button
                onClick={function() {
                  setPaymentMethod("addCustomer");
                  setIsAddCustomerModalOpen(true);
                }}
                className={paymentMethod === "addCustomer" ? "p-3 rounded text-lg bg-blue-600 text-white" : "p-3 rounded text-lg bg-gray-200 hover:bg-gray-300"}
              >
                {t.addCustomer}
              </button>
            </div>
            <button
              onClick={onClose}
              className="bg-gray-500 text-white p-2 rounded w-full hover:bg-gray-600"
            >
              {t.close}
            </button>
            <SelectCustomerModal
              isOpen={isSelectCustomerModalOpen}
              onClose={function() {
                setIsSelectCustomerModalOpen(false);
                onClose();
              }}
              onSelectCustomer={handleSelectCustomer}
              customers={customers}
              cart={cart}
              discount={discount}
              onClearCart={onClearCart}
              t={t}
              isDebtPayment={true}
            />
            <SelectCustomerModal
              isOpen={isAddCustomerModalOpen}
              onClose={function() {
                setIsAddCustomerModalOpen(false);
              }}
              onSelectCustomer={handleSelectCustomer}
              customers={customers}
              cart={cart}
              discount={discount}
              onClearCart={onClearCart}
              t={t}
              isDebtPayment={false}
            />
            <CashPaymentModal
              isOpen={isCashModalOpen}
              onClose={function() {
                setIsCashModalOpen(false);
                onClose();
              }}
              onConfirm={onConfirm}
              cart={cart}
              discount={discount}
              t={t}
              selectedCustomer={selectedCustomer}
            />
          </div>
        </div>
      );
    }

    // Main App Component
    function App() {
      const [cart, setCart] = React.useState([]);
      const [barcode, setBarcode] = React.useState("");
      const [discount, setDiscount] = React.useState(0);
      const [activeModule, setActiveModule] = React.useState("sales");
      const [isModalOpen, setIsModalOpen] = React.useState(false);
      const [isSuspendedModalOpen, setIsSuspendedModalOpen] = React.useState(false);
      const [isPaymentModalOpen, setIsPaymentModalOpen] = React.useState(false);
      const [isMemberPriceModalOpen, setIsMemberPriceModalOpen] = React.useState(false);
      const [suspendedTransactions, setSuspendedTransactions] = React.useState(function() {
        var saved = localStorage.getItem('suspendedTransactions');
        return saved ? JSON.parse(saved) : [];
      });
      const [resumedTransactionId, setResumedTransactionId] = React.useState(null);
      const [language, setLanguage] = React.useState(localStorage.getItem('language') || 'zh');

      function handleLanguageChange(lang) {
        setLanguage(lang);
        localStorage.setItem('language', lang);
        document.documentElement.lang = lang;
        document.title = translations[lang].title;
      }

      function handleScan(e) {
        e.preventDefault();
        var product = products.find(function(p) {
          return p.barcode === barcode || p.id === barcode;
        });
        if (product) {
          var existingItem = cart.find(function(item) {
            return item.id === product.id;
          });
          if (existingItem) {
            var newCart = cart.map(function(item) {
              return item.id === product.id ? { ...item, quantity: item.quantity + 1 } : item;
            });
            setCart(newCart);
          } else {
            setCart(cart.concat([{ ...product, quantity: 1 }]));
          }
          setBarcode("");
        } else {
          alert(translations[language].errorNoProduct);
        }
      }

      function handleSelectProduct(product) {
        var existingItem = cart.find(function(item) {
          return item.id === product.id;
        });
        if (existingItem) {
          var newCart = cart.map(function(item) {
            return item.id === product.id ? { ...item, quantity: item.quantity + 1 } : item;
          });
          setCart(newCart);
        } else {
          setCart(cart.concat([product]));
        }
      }

      function updateQuantity(index, delta) {
        var newCart = cart.slice();
        newCart[index].quantity = Math.max(1, newCart[index].quantity + delta);
        setCart(newCart);
      }

      function removeItem(index) {
        var newCart = cart.filter(function(_, i) {
          return i !== index;
        });
        setCart(newCart);
      }

      function calculateTotal() {
        var subtotal = cart.reduce(function(sum, item) {
          return sum + item.price * item.quantity;
        }, 0);
        var discountAmount = subtotal * (discount / 100);
        return {
          originalPrice: subtotal.toFixed(2),
          discountedPrice: (subtotal - discountAmount).toFixed(2)
        };
      }

      function handlePaymentConfirm(paymentMethod, ticket) {
        setCart([]);
        setDiscount(0);
        if (resumedTransactionId) {
          var updatedTransactions = suspendedTransactions.filter(function(transaction) {
            return transaction.id !== resumedTransactionId;
          });
          setSuspendedTransactions(updatedTransactions);
          localStorage.setItem("suspendedTransactions", JSON.stringify(updatedTransactions));
          setResumedTransactionId(null);
        }
      }

      function handleSuspend(transaction) {
        var updatedTransactions = suspendedTransactions.concat([transaction]);
        setSuspendedTransactions(updatedTransactions);
        localStorage.setItem("suspendedTransactions", JSON.stringify(updatedTransactions));
        setCart([]);
        setDiscount(0);
        setIsPaymentModalOpen(false);
      }

      function clearCart() {
        setCart([]);
        setDiscount(0);
        setIsPaymentModalOpen(false);
      }

      function suspendTransaction() {
        if (cart.length === 0) {
          alert(translations[language].errorNoSuspend);
          return;
        }
        var subtotal = cart.reduce(function(sum, item) {
          return sum + item.price * item.quantity;
        }, 0);
        var discountAmount = subtotal * (discount / 100);
        var total = (subtotal - discountAmount).toFixed(2);
        var transaction = {
          id: "transaction-" + Date.now() + "-" + Math.random().toString(36).slice(2, 9),
          cart: cart.slice(),
          discount: discount,
          total: parseFloat(total),
          timestamp: new Date().toLocaleString(language === 'es' ? "es-ES" : "zh-CN"),
          customerName: language === 'es' ? 'Ninguno' : '无'
        };
        handleSuspend(transaction);
      }

      function applyMemberPrice(selectedDiscount) {
        if (cart.length === 0) {
          alert(translations[language].errorEmptyCartMember);
          return;
        }
        if (discount > 0) {
          alert(translations[language].errorDiscountApplied);
          return;
        }
        setDiscount(selectedDiscount);
      }

      function resetDiscount() {
        setDiscount(0);
      }

      function resumeTransaction(transaction) {
        setCart(transaction.cart);
        setDiscount(transaction.discount);
        setResumedTransactionId(transaction.id);
        var updatedTransactions = suspendedTransactions.filter(function(t) {
          return t.id !== transaction.id;
        });
        setSuspendedTransactions(updatedTransactions);
        localStorage.setItem("suspendedTransactions", JSON.stringify(updatedTransactions));
        setIsSuspendedModalOpen(false);
      }

      function renderModule() {
        switch (activeModule) {
          case "sales":
            return (
              <div className="flex h-full p-4">
                <div className="w-1/3 pr-4">
                  <div className="flex items-center mb-4">
                    <h2 className="text-xl font-bold mr-4">{translations[language].newSale}</h2>
                    <select
                      value={language}
                      onChange={function(e) { handleLanguageChange(e.target.value); }}
                      className="p-1 rounded bg-gray-200 text-sm"
                    >
                      <option value="es">{translations[language].spanish}</option>
                      <option value="zh">{translations[language].chinese}</option>
                    </select>
                  </div>
                  <div className="mb-6">
                    <h3 className="text-lg font-semibold mb-2">{translations[language].scanProduct}</h3>
                    <form onSubmit={handleScan}>
                      <input
                        type="text"
                        value={barcode}
                        onChange={function(e) { setBarcode(e.target.value); }}
                        placeholder={translations[language].barcodePlaceholder}
                        className="border p-3 rounded w-full text-lg"
                        autoFocus
                      />
                    </form>
                  </div>
                  <div className="mb-6">
                    <button
                      onClick={function() { setIsModalOpen(true); }}
                      className="bg-blue-600 text-white p-3 rounded w-full text-lg hover:bg-blue-700"
                    >
                      {translations[language].manualInput}
                    </button>
                  </div>
                  <div className="mb-6">
                    <label className="block text-sm font-medium mb-1">{translations[language].discount}</label>
                    <input
                      type="number"
                      value={discount}
                      onChange={function(e) { setDiscount(Number(e.target.value)); }}
                      className="border p-2 rounded w-full"
                      min="0"
                      max="100"
                    />
                  </div>
                  <div className="mb-6">
                    <button
                      onClick={suspendTransaction}
                      className="bg-yellow-600 text-white p-3 rounded w-full text-lg hover:bg-yellow-700"
                      disabled={cart.length === 0}
                    >
                      {translations[language].suspend}
                    </button>
                  </div>
                  <div className="mb-6">
                    <button
                      onClick={function() { setIsMemberPriceModalOpen(true); }}
                      className="bg-teal-600 text-white p-3 rounded w-full text-lg hover:bg-teal-700"
                      disabled={cart.length === 0}
                    >
                      {translations[language].memberPrice}
                    </button>
                  </div>
                  {suspendedTransactions.length > 0 && (
                    <div className="mb-6">
                      <button
                        onClick={function() { setIsSuspendedModalOpen(true); }}
                        className="bg-purple-600 text-white p-3 rounded w-full text-lg hover:bg-purple-700"
                      >
                        {translations[language].viewSuspended}
                      </button>
                    </div>
                  )}
                  <ProductModal
                    isOpen={isModalOpen}
                    onClose={function() { setIsModalOpen(false); }}
                    onSelectProduct={handleSelectProduct}
                    products={products}
                    t={translations[language]}
                  />
                  <SuspendedTransactionsModal
                    isOpen={isSuspendedModalOpen}
                    onClose={function() { setIsSuspendedModalOpen(false); }}
                    suspendedTransactions={suspendedTransactions}
                    onResumeTransaction={resumeTransaction}
                    t={translations[language]}
                  />
                  <PaymentModal
                    isOpen={isPaymentModalOpen}
                    onClose={function() { setIsPaymentModalOpen(false); }}
                    onConfirm={handlePaymentConfirm}
                    cart={cart}
                    discount={discount}
                    onClearCart={clearCart}
                    t={translations[language]}
                  />
                  <MemberPriceModal
                    isOpen={isMemberPriceModalOpen}
                    onClose={function() { setIsMemberPriceModalOpen(false); }}
                    onSelectPrice={applyMemberPrice}
                    t={translations[language]}
                  />
                </div>
                <div className="w-2/3 bg-gray-50 p-4 rounded-lg shadow relative">
                  <h2 className="text-xl font-bold mb-4">{translations[language].cart}</h2>
                  {cart.length === 0 ? (
                    <p className="text-gray-500">{translations[language].noProducts}</p>
                  ) : (
                    <table className="w-full border-collapse">
                      <thead>
                        <tr className="bg-gray-200">
                          <th className="border p-3 text-left">{translations[language].product}</th>
                          <th className="border p-3 text-left">{translations[language].unitPrice}</th>
                          <th className="border p-3 text-left">{translations[language].quantity}</th>
                          <th className="border p-3 text-left">{translations[language].stock}</th>
                          <th className="border p-3 text-left">{translations[language].total}</th>
                          <th className="border p-3 text-left">{translations[language].actions}</th>
                        </tr>
                      </thead>
                      <tbody>
                        {cart.map(function(item, index) {
                          return (
                            <tr key={index}>
                              <td className="border p-3">{language === 'es' ? item.name_es || item.name : item.name}</td>
                              <td className="border p-3">€{item.price.toFixed(2)}</td>
                              <td className="border p-3">{item.quantity}</td>
                              <td className={item.stock <= item.safetyStock ? "border p-3 text-red-600" : "border p-3"}>
                                {item.stock}
                              </td>
                              <td className="border p-3">€{(item.price * item.quantity).toFixed(2)}</td>
                              <td className="border p-3">
                                <button
                                  onClick={function() { updateQuantity(index, 1); }}
                                  className="bg-green-500 text-white px-3 py-1 rounded mr-2 hover:bg-green-600"
                                >
                                  +
                                </button>
                                <button
                                  onClick={function() { updateQuantity(index, -1); }}
                                  className="bg-red-500 text-white px-3 py-1 rounded mr-2 hover:bg-red-600"
                                >
                                  -
                                </button>
                                <button
                                  onClick={function() { removeItem(index); }}
                                  className="bg-gray-500 text-white px-3 py-1 rounded hover:bg-gray-600"
                                >
                                  🗑
                                </button>
                              </td>
                            </tr>
                          );
                        })}
                      </tbody>
                    </table>
                  )}
                  <div className="absolute bottom-4 left-4 flex flex-col space-y-2">
                    {discount > 0 ? (
                      <>
                        <p className="text-lg font-semibold">{translations[language].originalPrice}: €{calculateTotal().originalPrice}</p>
                        <p className="text-lg font-semibold">{translations[language].discountedPrice}: €{calculateTotal().discountedPrice}</p>
                      </>
                    ) : (
                      <p className="text-lg font-semibold">{translations[language].totalAmount}: €{calculateTotal().discountedPrice}</p>
                    )}
                    {discount > 0 && (
                      <button
                        onClick={resetDiscount}
                        className="bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700"
                      >
                        {translations[language].restore}
                      </button>
                    )}
                  </div>
                  <div className="absolute bottom-4 right-4">
                    <button
                      onClick={function() { setIsPaymentModalOpen(true); }}
                      className="bg-green-600 text-white w-12 h-12 rounded-full flex items-center justify-center text-lg hover:bg-green-700"
                      disabled={cart.length === 0}
                    >
                      💳
                    </button>
                  </div>
                </div>
              </div>
            );
          case "inventory":
            return <div className="p-6">{translations[language].inventoryModule}</div>;
          case "membership":
            return <div className="p-6">{translations[language].membershipModule}</div>;
          case "payments":
            return <div className="p-6">{translations[language].paymentsModule}</div>;
          case "reports":
            return <div className="p-6">{translations[language].reportsModule}</div>;
          case "users":
            return <div className="p-6">{translations[language].usersModule}</div>;
          default:
            return null;
        }
      }

      return (
        <ErrorBoundary t={translations[language]}>
          <div className="flex h-screen">
            <div className="w-16 bg-gray-900 text-white flex flex-col items-center py-4 fixed h-full shadow-lg">
              <h1 className="text-lg font-bold mb-8">{translations[language].pos}</h1>
              <nav className="flex flex-col space-y-4">
                <button
                  onClick={function() { setActiveModule("sales"); }}
                  className={activeModule === "sales" ? "p-2 rounded-full bg-blue-600" : "p-2 rounded-full hover:bg-gray-700"}
                  title={translations[language].sales}
                >
                  🛒
                </button>
                <button
                  onClick={function() { setActiveModule("inventory"); }}
                  className={activeModule === "inventory" ? "p-2 rounded-full bg-blue-600" : "p-2 rounded-full hover:bg-gray-700"}
                  title={translations[language].inventory}
                >
                  📦
                </button>
                <a
                  href="cliente.html"
                  className={activeModule === "membership" ? "p-2 rounded-full bg-blue-600" : "p-2 rounded-full hover:bg-gray-700"}
                  title={translations[language].membership}
                >
                  👤
                </a>
                <button
                  onClick={function() { setActiveModule("payments"); }}
                  className={activeModule === "payments" ? "p-2 rounded-full bg-blue-600" : "p-2 rounded-full hover:bg-gray-700"}
                  title={translations[language].payments}
                >
                  💳
                </button>
                <button
                  onClick={function() { setActiveModule("reports"); }}
                  className={activeModule === "reports" ? "p-2 rounded-full bg-blue-600" : "p-2 rounded-full hover:bg-gray-700"}
                  title={translations[language].reports}
                >
                  📊
                </button>
                <button
                  onClick={function() { setActiveModule("users"); }}
                  className={activeModule === "users" ? "p-2 rounded-full bg-blue-600" : "p-2 rounded-full hover:bg-gray-700"}
                  title={translations[language].users}
                >
                  🔒
                </button>
                <a
                  href="tickets.html"
                  className="p-2 rounded-full hover:bg-gray-700"
                  title={translations[language].tickets}
                >
                  🎫
                </a>
                <a
                  href="deuda.html"
                  className="p-2 rounded-full hover:bg-gray-700"
                  title={translations[language].debt}
                >
                  📋
                </a>
              </nav>
            </div>
            <div className="ml-16 w-full bg-white p-4">{renderModule()}</div>
          </div>
        </ErrorBoundary>
      );
    }

    // Render the app using createRoot
    var rootElement = document.getElementById("root");
    var root = ReactDOM.createRoot(rootElement);
    root.render(<App />);
  </script>
</body>
</html>